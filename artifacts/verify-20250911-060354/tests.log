
> api-factory-backend@1.0.0 test /workspaces/api-factory/api-factory/backend
> jest --config ./jest.config.js --runInBand

FAIL src/routes/sdk-templates.test.ts
  ● SDK Templates API › should upload a template

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      32 |       headers: { 'content-type': 'application/json' },
      33 |     });
    > 34 |     expect(res.statusCode).toBe(200);
         |                            ^
      35 |     expect(JSON.parse(res.body).status).toBe('ok');
      36 |   });
      37 | });

      at Object.<anonymous> (src/routes/sdk-templates.test.ts:34:28)

PASS src/e2e/resources.e2e.test.ts
  ● Console

    console.log
      [server] {"level":30,"time":1757570643843,"pid":40767,"hostname":"codespaces-e67035","msg":"Using dev static file handler (USE_DEV_FALLBACKS=1)"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643872,"pid":40767,"hostname":"codespaces-e67035","msg":"Server listening at http://[::1]:3010"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643873,"pid":40767,"hostname":"codespaces-e67035","msg":"Server listening at http://127.0.0.1:3010"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643873,"pid":40767,"hostname":"codespaces-e67035","msg":"Server listening on http://localhost:3010"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643912,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-1","req":{"method":"GET","url":"/_api/healthz","host":"localhost:3010","remoteAddress":"::1","remotePort":45038},"msg":"incoming request"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643916,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-1","res":{"statusCode":200},"responseTime":3.1581830009818077,"msg":"request completed"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643924,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-2","req":{"method":"POST","url":"/api/v1/keys","host":"localhost:3010","remoteAddress":"::1","remotePort":45046},"msg":"incoming request"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643926,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-2","res":{"statusCode":201},"responseTime":2.109434999525547,"msg":"request completed"}
      {"level":30,"time":1757570643931,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-3","req":{"method":"POST","url":"/api/v1/resources","host":"localhost:3010","remoteAddress":"::1","remotePort":45038},"msg":"incoming request"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643934,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-3","res":{"statusCode":201},"responseTime":2.8922859989106655,"msg":"request completed"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643935,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-4","req":{"method":"GET","url":"/api/v1/resources/4153bbce-08a4-4950-905a-09278e795c46","host":"localhost:3010","remoteAddress":"::1","remotePort":45046},"msg":"incoming request"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

    console.log
      [server] {"level":30,"time":1757570643937,"pid":40767,"hostname":"codespaces-e67035","reqId":"req-4","res":{"statusCode":200},"responseTime":1.137713000178337,"msg":"request completed"}

      at Socket.<anonymous> (src/e2e/resources.e2e.test.ts:11:42)

PASS src/routes/consent.test.ts
PASS src/routes/resources.test.ts
PASS src/routes/stripe-webhook.test.ts
PASS src/routes/admin-releases.test.ts
PASS src/routes/hello.test.ts
PASS src/routes/tiers.test.ts
PASS src/routes/marketplace.test.ts
PASS src/routes/billing.test.ts

Test Suites: 1 failed, 9 passed, 10 total
Tests:       1 failed, 20 passed, 21 total
Snapshots:   0 total
Time:        4.286 s, estimated 8 s
Ran all test suites.
npm tests failed (see tests.log)
